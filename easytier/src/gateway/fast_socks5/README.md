Code is modified from https://github.com/dizda/fast-socks5
